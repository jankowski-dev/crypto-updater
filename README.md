# Notion Database Connector

Python скрипт для подключения к таблице (базе данных) Notion с использованием Notion API.

## Описание

Этот скрипт предназначен для тестирования подключения к базе данных Notion и может быть развернут на платформе Railway для автоматического мониторинга доступности подключения.

## Возможности

- ✅ Подключение к Notion API
- ✅ Проверка доступа к базе данных
- ✅ Получение информации о базе данных
- ✅ Подсчет количества записей
- ✅ Логирование результатов
- ✅ Обработка ошибок подключения
- ✅ Готов для деплоя на Railway

## Требования

- Python 3.7+
- Notion аккаунт с созданной интеграцией
- Доступ к базе данных Notion

## Установка и настройка

### 1. Создание интеграции в Notion

1. Перейдите на https://www.notion.so/my-integrations
2. Нажмите "New integration"
3. Заполните название и выберите workspace
4. Скопируйте полученный токен (начинается с `secret_`)

### 2. Предоставление доступа к базе данных

1. Откройте вашу базу данных в Notion
2. Нажмите "Share" в правом верхнем углу
3. Добавьте созданную интеграцию в список доступных

### 3. Получение ID базы данных

1. Откройте страницу с базой данных
2. Скопируйте ID из URL (32-символьная строка после последнего дефиса)
3. Пример: `https://notion.so/Ваша-страница-a1b2c3d4e5f6g7h8i9j0k1l2m3n4o5p6`

### 4. Локальная разработка

1. Клонируйте или скачайте файлы проекта
2. Установите зависимости:
   ```bash
   pip install -r requirements.txt
   ```
3. Создайте файл `.env` на основе `.env.example`
4. Заполните переменные среды в `.env`
5. Запустите скрипт:
   ```bash
   python notion_connector.py
   ```

## Деплой на Railway

### Вариант 1: Через веб-интерфейс Railway

1. Перейдите на https://railway.app
2. Зарегистрируйтесь или войдите в аккаунт
3. Нажмите "New Project"
4. Выберите "Deploy from GitHub repo" или "Empty Project"
5. Если выбрали "Empty Project", загрузите файлы проекта
6. После создания проекта перейдите в раздел "Variables"
7. Добавьте переменные среды:
   - `NOTION_TOKEN` = ваш токен интеграции Notion
   - `NOTION_DATABASE_ID` = ID вашей базы данных
8. Railway автоматически определит и установит зависимости из `requirements.txt`
9. Скрипт будет запущен автоматически

### Вариант 2: Через Railway CLI

1. Установите Railway CLI:
   ```bash
   npm install -g @railway/cli
   ```

2. Войдите в аккаунт:
   ```bash
   railway login
   ```

3. В директории с проектом выполните:
   ```bash
   railway init
   ```

4. Добавьте переменные среды:
   ```bash
   railway variables set NOTION_TOKEN=ваш_токен
   railway variables set NOTION_DATABASE_ID=ваш_id_базы
   ```

5. Задеплойте проект:
   ```bash
   railway up
   ```

## Логи

Скрипт выводит подробные логи в консоль:

- `INFO`: Информационные сообщения о процессе подключения
- `ERROR`: Ошибки подключения с описанием проблемы
- `✅ Подключение к Notion установлено успешно`: Успешное подключение
- `❌ Не удалось подключиться к Notion`: Ошибка подключения

## Коды возврата

- `0`: Успешное подключение
- `1`: Ошибка подключения или неверные настройки

## Расширение функциональности

Скрипт легко расширить для добавления новых возможностей:

- Получение записей из базы данных
- Создание новых записей
- Обмен данных между Notion и другими системами
- Автоматический мониторинг изменений

## Структура проекта

```
notion-connector/
├── notion_connector.py    # Основной скрипт
├── requirements.txt       # Зависимости Python
├── .env.example          # Пример переменных среды
└── README.md             # Документация
```

## Безопасность

- Токен интеграции Notion хранится в переменных среды
- Не передавайте токен третьим лицам
- Регулярно обновляйте токены доступа
- Используйте принцип минимальных привилегий для интеграции

## Поддержка

При возникновении проблем:

1. Проверьте правильность токена и ID базы данных
2. Убедитесь, что интеграция добавлена в список доступных для базы данных
3. Проверьте логи выполнения скрипта
4. Убедитесь, что база данных доступна и не удалена

## Лицензия

Этот проект распространяется свободно для личного и коммерческого использования.